# =============================================================================
# WEALTH COACH AI - PRODUCTION ENVIRONMENT (VPS/Cloud)
# =============================================================================
# This file is for PRODUCTION deployment on VPS servers
# Uses cloud services: Supabase (PostgreSQL), Upstash (Redis), OpenAI
# Copy this to your VPS and configure with your actual credentials

# -----------------------------------------------------------------------------
# APPLICATION SETTINGS
# -----------------------------------------------------------------------------
APP_NAME="Wealth Coach AI"
APP_VERSION="1.0.0"
ENVIRONMENT="production"
DEBUG=false
LOG_LEVEL="WARNING"

# Server Configuration
HOST="0.0.0.0"
PORT=8000
WORKERS=4

# -----------------------------------------------------------------------------
# DATABASE - SUPABASE (Cloud PostgreSQL with pgvector)
# -----------------------------------------------------------------------------
# Get from: https://supabase.com/
# Format: postgresql://postgres:[PASSWORD]@db.[PROJECT-REF].supabase.co:5432/postgres
DATABASE_URL=postgresql://postgres:your-password@db.xxx.supabase.co:5432/postgres

# Connection Pool Settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# -----------------------------------------------------------------------------
# REDIS - UPSTASH (Cloud Redis)
# -----------------------------------------------------------------------------
# Get from: https://upstash.com/
# Format: redis://default:[PASSWORD]@[REGION].upstash.io:[PORT]
REDIS_URL=redis://default:your-password@region.upstash.io:port

# Redis Settings
REDIS_MAX_CONNECTIONS=50
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=5

# -----------------------------------------------------------------------------
# LLM CONFIGURATION - OPENAI
# -----------------------------------------------------------------------------
# Get from: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-proj-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
OPENAI_MODEL="gpt-3.5-turbo"
OPENAI_MAX_TOKENS=500
OPENAI_TEMPERATURE=0.7
OPENAI_TIMEOUT=30

# LLM Cost Controls
MAX_TOKENS_PER_REQUEST=500
MAX_REQUESTS_PER_USER_PER_DAY=100
ENABLE_STREAMING=true

# Fallback (disable for production)
ENABLE_LOCAL_FALLBACK=false

# -----------------------------------------------------------------------------
# VECTOR STORE - PGVECTOR (Integrated with Supabase)
# -----------------------------------------------------------------------------
# Embedding Model (HuggingFace)
EMBEDDING_MODEL="sentence-transformers/all-MiniLM-L6-v2"
EMBEDDING_DIMENSION=384
VECTOR_STORE_TYPE="pgvector"

# Vector Store Settings
VECTOR_STORE_COLLECTION="financial_knowledge"
VECTOR_TOP_K=5
VECTOR_SCORE_THRESHOLD=0.7

# -----------------------------------------------------------------------------
# SECURITY
# -----------------------------------------------------------------------------
# JWT Configuration - Generate with: openssl rand -hex 32
JWT_SECRET_KEY=generate-with-openssl-rand-hex-32
JWT_ALGORITHM="HS256"
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# Password Hashing
BCRYPT_ROUNDS=12

# CORS Configuration (adjust for your domain)
CORS_ORIGINS=*
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOW_HEADERS=*

# API Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_PERIOD=60

# -----------------------------------------------------------------------------
# SESSION & CACHE
# -----------------------------------------------------------------------------
SESSION_SECRET_KEY=generate-another-random-secret
SESSION_COOKIE_NAME="wealth_coach_session"
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE="lax"
SESSION_MAX_AGE=86400

# Cache Configuration
CACHE_ENABLED=true
CACHE_TTL=3600
CACHE_MAX_SIZE=1000

# -----------------------------------------------------------------------------
# FILE STORAGE (Optional - if using S3)
# -----------------------------------------------------------------------------
# AWS S3 Configuration
AWS_ACCESS_KEY_ID=""
AWS_SECRET_ACCESS_KEY=""
AWS_S3_BUCKET=""
AWS_REGION="us-east-1"

# Or use Supabase Storage
SUPABASE_STORAGE_BUCKET=""

# -----------------------------------------------------------------------------
# MONITORING & LOGGING
# -----------------------------------------------------------------------------
# Sentry (Optional - for error tracking)
SENTRY_DSN=""
SENTRY_ENVIRONMENT="production"

# Log Configuration
LOG_FORMAT="json"
LOG_FILE_ENABLED=false
LOG_FILE_PATH="/app/logs"
LOG_FILE_MAX_BYTES=10485760
LOG_FILE_BACKUP_COUNT=5

# Performance Monitoring
ENABLE_METRICS=true
METRICS_PORT=9090

# -----------------------------------------------------------------------------
# EMAIL (Optional - for notifications)
# -----------------------------------------------------------------------------
SMTP_HOST=""
SMTP_PORT=587
SMTP_USER=""
SMTP_PASSWORD=""
SMTP_FROM_EMAIL="noreply@wealthcoach.com"

# -----------------------------------------------------------------------------
# WEBHOOKS & INTEGRATIONS
# -----------------------------------------------------------------------------
WEBHOOK_SECRET=""
SLACK_WEBHOOK_URL=""

# -----------------------------------------------------------------------------
# FEATURE FLAGS
# -----------------------------------------------------------------------------
ENABLE_USER_REGISTRATION=true
ENABLE_PASSWORD_RESET=true
ENABLE_EMAIL_VERIFICATION=false
ENABLE_TWO_FACTOR_AUTH=false
ENABLE_ANALYTICS=true

# -----------------------------------------------------------------------------
# BUSINESS LOGIC
# -----------------------------------------------------------------------------
MAX_CHAT_HISTORY=50
MAX_FILE_UPLOAD_SIZE=10485760
ALLOWED_FILE_TYPES="pdf,txt,docx,csv"

# Knowledge Base
KNOWLEDGE_BASE_PATH="/app/data/knowledge_base"
ENABLE_AUTO_KNOWLEDGE_UPDATE=false

# User Limits
FREE_TIER_MONTHLY_REQUESTS=100
PREMIUM_TIER_MONTHLY_REQUESTS=1000

# -----------------------------------------------------------------------------
# PRODUCTION OPTIMIZATIONS
# -----------------------------------------------------------------------------
# Gunicorn Settings (in Dockerfile.prod)
GUNICORN_WORKERS=4
GUNICORN_WORKER_CLASS="uvicorn.workers.UvicornWorker"
GUNICORN_WORKER_CONNECTIONS=1000
GUNICORN_MAX_REQUESTS=1000
GUNICORN_MAX_REQUESTS_JITTER=50
GUNICORN_TIMEOUT=30
GUNICORN_KEEPALIVE=5

# -----------------------------------------------------------------------------
# IMPORTANT NOTES
# -----------------------------------------------------------------------------
# 1. Replace ALL placeholder values before deploying
# 2. NEVER commit this file with real credentials to Git
# 3. Generate JWT_SECRET_KEY: openssl rand -hex 32
# 4. Enable pgvector in Supabase: CREATE EXTENSION IF NOT EXISTS vector;
# 5. Set CORS_ORIGINS to your actual domain after testing
# 6. Keep this file secure with: chmod 600 .env.production
